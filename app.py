from flask import Flask, render_template, url_for, redirect, request
import functions
import os 


############################
### Initialize flask app ###
############################
app = Flask(__name__)


##############
### ROUTES ###
##############
#-----------------------------------------------------------------
@app.route('/')
def go_home():
    return redirect('/index')
#-----------------------------------------------------------------
@app.route('/index')
def index():
    return render_template('index.html', title="Twitter Scraper")
#-----------------------------------------------------------------
@app.route('/scrape', methods=['POST'])
def scrape():
    email = request.form['email']
    password = request.form['password']
    search = request.form['search']
    tweet_limit = request.form['tweet_limit']
    sleep_time = request.form['sleep_time']
    
    data_html, data_csv = functions.main(email, password, search, tweet_limit, sleep_time)
    # data_html = '<table border="1" class="dataframe">\n  <thead>\n    <tr style="text-align: right;">\n      <th></th>\n      <th>Name</th>\n      <th>Handle</th>\n      <th>Timestamp</th>\n      <th>Comment</th>\n      <th>Original_Content</th>\n      <th>Replies</th>\n      <th>Retweets</th>\n      <th>Likes</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>GermSmashers</td>\n      <td>@GermSmashers</td>\n      <td>2021-07-29T17:00:06.000Z</td>\n      <td>Germ Smashers - Nashville Sanitizing Service - We Make Germs Bite The Dust !!!\\nCall Germ Smashers at 615-964-4376 (GERM) and get certified CLEAN today!!\\nhttp://germsmashers.com\\n\\n#VirusCorona #Viruses #SanitiseToKillCorona #disinfectant #Nashville</td>\n      <td></td>\n      <td></td>\n      <td></td>\n      <td></td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>NashvilleOktoberfest</td>\n      <td>@OktoberfestNash</td>\n      <td>2021-07-29T17:00:05.000Z</td>\n      <td>Fun fact - We are a family friendly event! Bring everyone in the fam and have a great time. #nashvilleoktoberfest \\n\\nJoin us October 7-10!\\n\\n#thenashvilleoktoberfest #oktoberfest #nashokt #nashvilleoktoberfest2021 #nashvillefestival #nashvilleevents #nashville #nashvilletn</td>\n      <td></td>\n      <td></td>\n      <td></td>\n      <td></td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>eVisitorGuide</td>\n      <td>@eVisitorGuide</td>\n      <td>2021-07-29T16:53:03.000Z</td>\n      <td>.\\n@RockBottom\\n #Nashville is the only #brewery on Broadway! Great location, outstanding food, award-winning #CraftBeer, #livemusic &amp; awesome rooftop deck! What more do you need?! https://evisitorguide.com/nashville/brochures/rock-bottom-restaurant-brewery-brew-pub-downtown-nashville.php… #MusicCity #travel #sightseeing #beer #dining #nightlife</td>\n      <td></td>\n      <td></td>\n      <td></td>\n      <td></td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>BestDealsEver</td>\n      <td>@MilwaukeeHotBuy</td>\n      <td>2021-07-29T16:53:01.000Z</td>\n      <td>VETERANS https://buff.ly/2IsKz1W  recovery documentary free on this link or Amazon Prime #overdose #addicts #addiction #na #aa #soar12steps #comedy #laughfactory #ks #nashville</td>\n      <td></td>\n      <td></td>\n      <td></td>\n      <td></td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>NCMEC</td>\n      <td>@MissingKids</td>\n      <td>2021-07-29T16:49:56.000Z</td>\n      <td>Have you seen this child? Asia Black \\n\\nAsia was last seen on June 17, 2021 in #Nashville, TN. She may be in the company of an adult male. They may still be in the local area. \\n@MNPDNashville</td>\n      <td></td>\n      <td></td>\n      <td>62</td>\n      <td>17</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>Ashley Noelle</td>\n      <td>@IAmAshleyNoelle</td>\n      <td>2021-07-29T16:49:29.000Z</td>\n      <td>#ashleynoelle #djsandy #DestinyMuah #seaawards #BoyDogEntertainment #BoyDogWorld #Nashville #Atlanta #ashleynoellemusic</td>\n      <td></td>\n      <td></td>\n      <td></td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>TMJ - BNA Bank Jobs</td>\n      <td>@tmj_bna_banking</td>\n      <td>2021-07-29T16:48:40.000Z</td>\n      <td>If jobs with titles like "Float Client Relationship Consultant Banker 3 Nashville Commerce - TN (40 Hours)" sound appealing to you, follow us to hear about these types of opportunities in #Nashville, TN. #branchbanking</td>\n      <td></td>\n      <td></td>\n      <td></td>\n      <td></td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>eVisitorGuide</td>\n      <td>@eVisitorGuide</td>\n      <td>2021-07-29T16:48:03.000Z</td>\n      <td>Use \\n@eVisitorGuide\\n to find fun things to see &amp; do in #Nashville! (It\'s #FREE!) Honky Tonks, distilleries, #museums, #attractions, #dining, #tours and more! Open browser to https://evisitorguide.com/nashville and start exploring! The perfect #smartphone guide! #travel #sightseeing</td>\n      <td></td>\n      <td></td>\n      <td></td>\n      <td></td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>Lee Gibson</td>\n      <td>@leegibsonmusic</td>\n      <td>2021-07-29T16:48:00.000Z</td>\n      <td>I\'ll be hosting an acoustic concert series AND performing a show via \\n@NiteOfNashville\\n so I hope y\'all would do me the tiny favor of heading to their page &amp; giving them a follow. We\'ll be announcing dates for this series next week! #Nashville #Songwriters #CountryMusic</td>\n      <td></td>\n      <td></td>\n      <td></td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>9</th>\n      <td>Fil Rodrigues</td>\n      <td>@FRod401</td>\n      <td>2021-07-29T16:47:43.000Z</td>\n      <td>https://vm.tiktok.com/ZMdvQadLm/ \\n@BarstoolBigCat\\n @PFTCommenter\\n @TroopzAFC\\n @stoolpresidente\\n @FLAGALine\\n #Nashville #BarstoolSearch I’m the next employee for you el pres</td>\n      <td>Fil Rodrigues on TikTok\\n#barstoolsearch #fyi #portuguese #nashville\\nm.tiktok.com</td>\n      <td>1</td>\n      <td></td>\n      <td></td>\n    </tr>\n    <tr>\n      <th>10</th>\n      <td>April</td>\n      <td>@april_dd</td>\n      <td>2021-07-29T16:46:25.000Z</td>\n      <td>If there\'s an affordable housing crunch in #Nashville, why would the city allow developers to demolish perfectly good and usable section 8 housing? The councilman\'s response to where displaced families are supposed to go: "that\'s tough".</td>\n      <td>Priced Out: East Nashville residents fed up with new developments in longtime communities\\nA group of Nashville residents say they’re sick of new developments pricing them out of their long time communities. The same renters are not shying away from sharing their disapproval with a...\\nfox17.com</td>\n      <td></td>\n      <td></td>\n      <td></td>\n    </tr>\n    <tr>\n      <th>11</th>\n      <td>Karen Davis</td>\n      <td>@CoachKaren13</td>\n      <td>2021-07-29T16:45:41.000Z</td>\n      <td>Go forth and vote for \\n@SoccerMoses\\n \\n#Everyonen #Nashville</td>\n      <td>Quote Tweet\\nSoccer Moses\\n@SoccerMoses\\n · 2h\\n \\nI COME FROM THE MOUNTAIN TOP\\nWITH AN IMPORTANT DECREE:\\nTHOU SHALT VOTE FOR SOCCER MOSES\\nIN THE BEST OF NASHVILLE 2021 @nashvillescene Readers Poll\\nhttps://nashvillescene.com/bon2021/ballot/\\nPeople&amp;Places/Best Religious Leader\\nPeople&amp;Places/Best Sports Mascot</td>\n      <td></td>\n      <td>1</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>12</th>\n      <td>elizabeth traub</td>\n      <td>@elizabethtraub</td>\n      <td>2021-07-29T16:45:03.000Z</td>\n      <td>I was visiting my daughter \\n@emilytheott\\n last week in #nashville . Found her paints, a piece of cardboard and started #painting. It was a peaceful feeling sitting in her beautiful home.</td>\n      <td></td>\n      <td></td>\n      <td></td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>13</th>\n      <td>Jennifer Benson</td>\n      <td>@jenniferbensonn</td>\n      <td>2021-07-29T16:44:13.000Z</td>\n      <td>Isaiah 40:31: "but those who hope in the LORD will renew their strength. They will soar on wings like eagles; they will run and not grow weary, they will walk and not be faint."\\n\\nSee you all at Lifest Music City, Tennessee today!\\n\\n#ignescent #tennessee #lifest #nashville #wings</td>\n      <td></td>\n      <td></td>\n      <td></td>\n      <td></td>\n    </tr>\n    <tr>\n      <th>14</th>\n      <td>ProDrivers_Jobs</td>\n      <td>@ProDrivers_Jobs</td>\n      <td>2021-07-29T16:44:11.000Z</td>\n      <td>ProDrivers is the largest truck driver services company in the United States specializing in CDL drivers, and we’re hiring in #Nashville, TN! Apply today: https://bit.ly/3j4xcVy #CDL</td>\n      <td>Local Non-CDL Delivery Driver in Nashville, TN\\nImmediate Hire for the Nashville TN area: Local NON CDL w/ F Endorsement driver Driver Job: -Days -Monday-Friday -$900-$1100 Weekly pay -Non CDL delivery Driver Requirements: -Driver must have at l...\\ncareerarc.com</td>\n      <td></td>\n      <td></td>\n      <td></td>\n    </tr>\n    <tr>\n      <th>15</th>\n      <td>Ignescent</td>\n      <td>@ignescentmusic</td>\n      <td>2021-07-29T16:42:58.000Z</td>\n      <td>"They will soar on wings like eagles; they will run and not grow weary, they will walk and not be faint."\\n\\nSee you all at Lifest Music City, Tennessee today on the Hollow Stage at 4:00 pm!\\n\\n#ignescent #tennessee #lifest #nashville #wings #rocknroll #rockband #chicago</td>\n      <td></td>\n      <td></td>\n      <td></td>\n      <td></td>\n    </tr>\n    <tr>\n      <th>16</th>\n      <td>Kim Hoard REALTOR</td>\n      <td>@kimhoard</td>\n      <td>2021-07-29T16:40:47.000Z</td>\n      <td>Check out this luxury home! #RealEstate #DreamHomes\\n615-319-1919\\n#KimberlyHoard #NashvilleRealEstate #KimberlyHoard.com #Nashville #6153191919\\n#BeBetterBeBenchmark</td>\n      <td>1021 Lock 4 Rd\\nSpacious ranch walking distance to the lake and partial lake view! 4BR, 3 Full bath with 3050 SF on over 2 acres with fruit trees, lots of parking, fenced back yard, 2 offices, formal dining room,...\\nhomes.benchmarkrealtytn.com</td>\n      <td></td>\n      <td></td>\n      <td></td>\n    </tr>\n    <tr>\n      <th>17</th>\n      <td>Nashville Geek</td>\n      <td>@nashvillegeek</td>\n      <td>2021-07-29T16:35:06.000Z</td>\n      <td>Picking a typeface to represent your site is more than looks alone. These tips will help you pick the best to elevate your brand.\\nhttps://pixel2pixeldesign.com/eight-things-to-consider-before-choosing-website-font/…\\n\\n#nashville #nashvilletn #wordpress #nashvillegeek #websitedesign #websdesign</td>\n      <td>Eight Things to Consider Before Choosing a Website Font\\nChoosing the website font isn\'t easy as you have to go through various processes to reach the perfect one finally.\\npixel2pixeldesign.com</td>\n      <td></td>\n      <td></td>\n      <td></td>\n    </tr>\n    <tr>\n      <th>18</th>\n      <td>SwankyB Boutique</td>\n      <td>@shopswankyb</td>\n      <td>2021-07-29T16:34:53.000Z</td>\n      <td>Happy Friday Jr.   Come see us &amp; our stylish denim shorts at Swanky B Boutique TODAY located in Opry Mills Mall near the rainforest cafe  #shop #summer #sale #fashion #oprymills #nashville #nashvilleboutique https://instagr.am/p/CR6sqcJszzy/</td>\n      <td></td>\n      <td></td>\n      <td></td>\n      <td></td>\n    </tr>\n    <tr>\n      <th>19</th>\n      <td>eVisitorGuide</td>\n      <td>@eVisitorGuide</td>\n      <td>2021-07-29T16:33:03.000Z</td>\n      <td>For a bit of #American #history, head to Andrew Jackson\'s Hermitage when in #Nashville. Former home and farm of U.S.\'s 7th President. Just 20 minutes from downtown. Learn more here: https://evisitorguide.com/nashville/brochures/andrew-jackson-hermitage-nashville-tennessee.php… #travel #sightseeing #educational #familyfriendly</td>\n      <td></td>\n      <td></td>\n      <td></td>\n      <td></td>\n    </tr>\n    <tr>\n      <th>20</th>\n      <td>TMJ-BNA Security Job</td>\n      <td>@tmj_BNA_secure</td>\n      <td>2021-07-29T16:31:08.000Z</td>\n      <td>Join the Allied Universal team! See our latest Security Supervisor job openings, including "Security Shift Supervisor - Retail", via the link in our bio. #MusicCity #Nashville, TN</td>\n      <td></td>\n      <td></td>\n      <td></td>\n      <td></td>\n    </tr>\n    <tr>\n      <th>21</th>\n      <td>Partners in Building</td>\n      <td>@partnersinbuild</td>\n      <td>2021-07-29T16:30:16.000Z</td>\n      <td>This kitchen gives a \'Wow!\' factor through beautiful, subtle details: brass hardware, a custom herringbone backsplash, and gorgeous natural hardwood floors. \\n\\nDesign the custom home of your dreams with Partners in Building #Nashville. http://ow.ly/gG2U50FFW0H</td>\n      <td></td>\n      <td></td>\n      <td></td>\n      <td></td>\n    </tr>\n    <tr>\n      <th>22</th>\n      <td>Myriam Najlis Garay</td>\n      <td>@MiminajlisG</td>\n      <td>2021-07-29T16:27:21.000Z</td>\n      <td>#Nashville #country #travel es una ciudad maravillosa, muy estilo americana y la gente sabe divertirse aquí... incluso existen un truck con piscina incluida adentro, y hasta coches de caballo (mulas super desarrolladas) me encanto</td>\n      <td></td>\n      <td></td>\n      <td></td>\n      <td></td>\n    </tr>\n    <tr>\n      <th>23</th>\n      <td>TMJ-BNA Skl. Trades</td>\n      <td>@tmj_BNA_skltrd</td>\n      <td>2021-07-29T16:25:47.000Z</td>\n      <td>This job might be a great fit for you: material handler - https://bit.ly/3BSFJ6E #SkilledTrade #Nashville, TN</td>\n      <td>material handler in Nashville, TN\\nJob Title: Material Handler Job Requisition Number: RC368499 Category: Operations Job Family: FXE-US: Handler/Dockworker Time Type: Part Time Locations: Nashville, Tennessee Provides safe and effic...\\ncareerarc.com</td>\n      <td></td>\n      <td></td>\n      <td></td>\n    </tr>\n  </tbody>\n</table>'
    # data_csv = "one, two, three, four, five"
    return render_template('scrape.html', title="Twitter Scraper", email=email, password=password, search=search, tweet_limit=tweet_limit, sleep_time=sleep_time,data_html=data_html, data_csv=data_csv)
#-----------------------------------------------------------------
## if you don't have a favicon, use this route to get rid of the 404 favicon error
# from flask import send_from_directory
# @app.route('/favicon.ico') 
# def favicon():     
#     return send_from_directory(os.path.join(app.root_path, 'static'), 'favicon.ico', mimetype='image/vnd.microsoft.icon')
#-----------------------------------------------------------------

# app import check
if __name__ == '__main__':
    app.run()  